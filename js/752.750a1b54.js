"use strict";(self["webpackChunkkinocms"]=self["webpackChunkkinocms"]||[]).push([[752],{7036:function(e,a,i){i.r(a),i.d(a,{default:function(){return G}});var t=i(3396),l=i(7139),r=i(9242);const n={class:"btn-group btn-group-toggle","data-toggle":"buttons"},o=["id"],s=(0,t._)("span",null,"Зберегти",-1),c=[s],d=(0,t._)("span",null,"Зберегти",-1),u=[d];function m(e,a,i,s,d,m){const g=(0,t.up)("addFilmC"),h=(0,t.up)("card");return(0,t.wg)(),(0,t.j4)(h,{title:d.title,isLoading:m.isLoading},{tools:(0,t.w5)((()=>[(0,t._)("div",n,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(d.languages,(e=>((0,t.wg)(),(0,t.iD)("label",{key:e.id,class:(0,l.C_)(["btn btn-secondary",{active:e.checked}])},[(0,t._)("input",{type:"radio",name:"options",id:e.id,autocomplete:"off",onChange:a[0]||(a[0]=(...e)=>m.changeCheckbox&&m.changeCheckbox(...e))},null,40,o),(0,t.Uk)(" "+(0,l.zw)(e.name),1)],2)))),128))])])),body:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(g,{language:"Ua",collectionRef:m.collection("Ua"),id:d.id,onIsLoading:m.changeLoadingUa,saveTriger:d.saveTriger,onErorr:m.changeErorrUa},null,8,["collectionRef","id","onIsLoading","saveTriger","onErorr"]),[[r.F8,"Ua"===m.currenLanguage]]),(0,t.wy)((0,t.Wm)(g,{language:"En",collectionRef:m.collection("En"),id:d.id,onIsLoading:m.changeLoadingEn,saveTriger:d.saveTriger,onErorr:m.changeErorrEn},null,8,["collectionRef","id","onIsLoading","saveTriger","onErorr"]),[[r.F8,"En"===m.currenLanguage]]),(0,t._)("button",{onClick:a[1]||(a[1]=(...e)=>m.Save&&m.Save(...e)),class:"btn btn-xs btn-success col fileinput-button"},c)])),footer:(0,t.w5)((()=>[(0,t._)("span",{class:"btn btn-xs btn-success col fileinput-button",onClick:a[2]||(a[2]=(...e)=>m.Save&&m.Save(...e))},u)])),_:1},8,["title","isLoading"])}i(7658);var g=i(4219),h=i(4494),p=i(36),f=i(4592),v=i(5660),y=i(117);const k={key:0,class:"error-message"},D={key:1,class:"error-message"},b={class:"form-group mt-3 ml-1"},$=(0,t._)("p",null,[(0,t._)("strong",null,"Тип фільма")],-1),L={key:0,class:"error-message"};function V(e,a,i,n,o,s){const c=(0,t.up)("input-component"),d=(0,t.up)("textarea-component"),u=(0,t.up)("img-component"),m=(0,t.up)("imgs-component"),g=(0,t.up)("checkbox-component"),h=(0,t.up)("seo-component");return(0,t.wg)(),(0,t.iD)("form",{action:"",onSubmit:a[10]||(a[10]=(0,r.iM)(((...e)=>s.Save&&s.Save(...e)),["prevent"]))},[(0,t.Wm)(c,{label:"Назва фільма",id:"filmName",type:"text",placeholder:"Введіть назву фільма",modelValue:o.filmName,"onUpdate:modelValue":a[0]||(a[0]=e=>o.filmName=e),error:n.v$.filmName.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,t.Wm)(c,{class:"mt-3",label:"Дата виходу",id:"releaseDate",type:"date",placeholder:"Введіть дату виходу",modelValue:o.releaseDate,"onUpdate:modelValue":a[1]||(a[1]=e=>o.releaseDate=e),error:n.v$.releaseDate.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,t.Wm)(d,{class:"mt-3",label:"Опис",id:"filmDescription",type:"textarea",placeholder:"Введіть опис фільма",modelValue:o.filmDescription,"onUpdate:modelValue":a[2]||(a[2]=e=>o.filmDescription=e),error:n.v$.filmDescription.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,t.Wm)(u,{modelValue:o.mainPicture,"onUpdate:modelValue":a[3]||(a[3]=e=>o.mainPicture=e),class:(0,l.C_)([{"is-invalid":n.v$.mainPicture.$error},"mt-3"]),onDeleteMainPicture:s.delImage},null,8,["modelValue","class","onDeleteMainPicture"]),n.v$.mainPicture.$error?((0,t.wg)(),(0,t.iD)("p",k,"Виберіть картинку")):(0,t.kq)("",!0),(0,t.Wm)(m,{modelValue:o.gallary,"onUpdate:modelValue":a[4]||(a[4]=e=>o.gallary=e),class:(0,l.C_)([{"is-invalid":n.v$.gallary.$error},"mt-3"]),onNewImage:s.addImage,onDelImage:s.delImage,onChangeImage:s.changeImage},null,8,["modelValue","class","onNewImage","onDelImage","onChangeImage"]),n.v$.gallary.$error?((0,t.wg)(),(0,t.iD)("p",D,"Виберіть картинку")):(0,t.kq)("",!0),(0,t.Wm)(c,{class:"mt-3",label:"Силка на трейлер",id:"trailerLink",type:"text",placeholder:"Введіть силку на трейлер в youtube...",modelValue:o.trailerLink,"onUpdate:modelValue":a[5]||(a[5]=e=>o.trailerLink=e),error:n.v$.trailerLink.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,t._)("div",b,[$,(0,t._)("div",{class:(0,l.C_)(["row",{"is-invalid":n.v$.typeFilm.$error}])},[(0,t.Wm)(g,{modelValue:o.typeFilm["3D"],"onUpdate:modelValue":a[6]||(a[6]=e=>o.typeFilm["3D"]=e),id:"3D",label:"3D"},null,8,["modelValue"]),(0,t.Wm)(g,{modelValue:o.typeFilm["2D"],"onUpdate:modelValue":a[7]||(a[7]=e=>o.typeFilm["2D"]=e),id:"2D",label:"2D"},null,8,["modelValue"]),(0,t.Wm)(g,{modelValue:o.typeFilm.IMAX,"onUpdate:modelValue":a[8]||(a[8]=e=>o.typeFilm.IMAX=e),id:"IMAX",label:"IMAX"},null,8,["modelValue"])],2),n.v$.typeFilm.$error?((0,t.wg)(),(0,t.iD)("p",L,"Виберіть тип фільма")):(0,t.kq)("",!0)]),(0,t.Wm)(h,{modelValue:o.SEO,"onUpdate:modelValue":a[9]||(a[9]=e=>o.SEO=e)},null,8,["modelValue"])],32)}var w=i(5420),F=i(7316),I=i(6099),U=i(8651),C=i(4803);const E={class:"form-check mx-auto"},S=["id","checked","disabled"],P=["for"];function _(e,a,i,r,n,o){return(0,t.wg)(),(0,t.iD)("div",E,[(0,t._)("input",{id:i.id,name:"check",class:"form-check-input",type:"checkbox",checked:i.modelValue,disabled:i.disabled,onInput:a[0]||(a[0]=a=>e.$emit("update:modelValue",a.target.checked))},null,40,S),i.label?((0,t.wg)(),(0,t.iD)("label",{key:0,for:i.id,class:"form-check-label"},(0,l.zw)(i.label),9,P)):(0,t.kq)("",!0)])}var x={props:{id:String,label:String,modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}}},T=i(89);const N=(0,T.Z)(x,[["render",_]]);var W=N,q=i(9866),z=i(151),Z=i(373),M=i.n(Z),O={components:{inputComponent:F.Z,imgComponent:U.Z,imgsComponent:C.Z,checkboxComponent:W,SeoComponent:q.Z,textareaComponent:I.Z},setup(){const e=(0,g.Xw)();return{v$:e}},data(){return{filmName:"",releaseDate:"",filmDescription:"",mainPicture:{},gallary:[],trailerLink:"",typeFilm:{"3D":!1,"2D":!1,IMAX:!1},SEO:{link:"",title:"",keywords:"",description:""},ListDeleteImages:[],cloudFirestore:new h.r,cloudStorage:new z.o}},props:{language:String,collectionRef:Object,id:String,saveTriger:Boolean},mounted(){this.GetFilm()},validations(){return{filmName:{required:w.C1,$lazy:!0},releaseDate:{required:w.C1,$lazy:!0},filmDescription:{required:w.C1,$lazy:!0},mainPicture:{required:w.C1,$lazy:!0},gallary:{required:w.C1,$lazy:!0},trailerLink:{required:w.C1,$lazy:!0},typeFilm:{required(e){return Object.values(e).some((e=>e))},$lazy:!0}}},computed:{fileFolderPath(){return`films/${this.language}/${this.id}`}},methods:{addImage(e){this.gallary.push(e)},delImage(e){this.ListDeleteImages.push(e)},changeImage(e){this.gallary=this.gallary.map((a=>a.id===e.id?e:a))},GetFilm(){this.ListDeleteImages=[],this.cloudFirestore.getDocument(this.collectionRef,this.$route.params.id).then((e=>{e&&Object.assign(this.$data,e)}))},async Save(){try{if(this.$emit("isLoading",!0),this.ListDeleteImages){for(let e=0;e<this.ListDeleteImages.length;e++)this.cloudStorage.DeleteFileInFirebaseStorage(this.fileFolderPath,this.ListDeleteImages[e]);this.ListDeleteImages=[]}if(await this.v$.$validate()){if(this.mainPicture.src?(this.mainPicture.link=await this.cloudStorage.UploadFile(this.fileFolderPath,this.mainPicture),this.saveListImgTriger=!this.saveListImgTriger,delete this.mainPicture.src):delete this.mainPicture,this.gallary.length)for(let a=0;a<this.gallary.length;a++)this.gallary[a].src&&(this.gallary[a].link=await this.cloudStorage.UploadFile(this.fileFolderPath,this.gallary[a]),delete this.gallary[a].src);const e={fileName:this.id,filmName:this.filmName,releaseDate:this.releaseDate,filmDescription:this.filmDescription,typeFilm:this.typeFilm,SEO:this.SEO,gallary:this.gallary,mainPicture:this.mainPicture,trailerLink:this.trailerLink};this.cloudFirestore.AddDocument(this.collectionRef,this.id,e)}console.log("save"),M().success(this.language),this.$emit("isLoading",!1)}catch(e){const a={unknown:"Сталася невідома помилка при збереженні даних."};this.$emit("erorr",!0);const i=a[e.code]||"Не вдалося зберегти дані.";throw new Error(i)}}},watch:{saveTriger(){this.Save()}}};const R=(0,T.Z)(O,[["render",V]]);var X=R,A={setup(){const e=(0,g.Xw)();return{v$:e}},data(){return{id:null,isLoadingUa:!1,isLoadingEn:!1,erorrUa:!1,erorrEn:!1,formValidate:!1,saveTriger:!1,uaValidate:!1,enValidate:!1,title:"Фільм",languages:[{id:0,name:"Українська",value:"Ua",checked:!1},{id:1,name:"Англійська",value:"En",checked:!0}],cloudFirestore:new h.r}},created(){this.GetFilm()},components:{card:y.Z,addFilmC:X},computed:{isLoading(){return!0===this.isLoadingEn||!0===this.isLoadingUa},error(){return!1!==this.erorrUa||!1!==this.erorrEn},curentIndex(){return!0===this.languages[0].checked?0:1},currenLanguage(){return!0===this.languages[0].checked?this.languages[0].value:this.languages[1].value},collectionRef(){const e=(0,p.JU)(f.hS,this.currenLanguage),a=(0,p.hJ)(e,"films");return a}},methods:{changeValidateStatus(e,a){a===this.uaValidate?this.uaValidate=e:this.enValidate=e},changeErorrUa(e){this.erorrUa=e},changeErorrEn(e){this.erorrEn=e},changeLoadingUa(e){this.isLoadingUa=e},changeLoadingEn(e){this.isLoadingEn=e},collection(e){const a=(0,p.JU)(f.hS,e),i=(0,p.hJ)(a,"films");return i},GetFilm(){this.cloudFirestore.getDocument(this.collection("En"),this.$route.params.id).then((e=>{e?this.id=this.$route.params.id:this.cloudFirestore.getDocument(this.collection("Ua"),this.$route.params.id).then((e=>{e?this.id=this.$route.params.id:(this.$router.push("New_Film"),this.id=(0,v.Cf)())}))}))},changeCheckbox(){!0===this.languages[0].checked?(this.languages[0].checked=!1,this.languages[1].checked=!0):(this.languages[1].checked=!1,this.languages[0].checked=!0)},async Save(){await this.v$.$validate()&&(this.saveTriger=!this.saveTriger)}}};const j=(0,T.Z)(A,[["render",m]]);var G=j}}]);
//# sourceMappingURL=752.750a1b54.js.map