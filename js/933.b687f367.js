"use strict";(self["webpackChunkkinocms"]=self["webpackChunkkinocms"]||[]).push([[933],{5660:function(e,t,i){i.d(t,{Cf:function(){return r}});var a=i(1609),l=i(36),n=i(1614);function r(){const e=new Date,t=e.getFullYear(),i=e.getMonth()+1,a=e.getDate(),l=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return`${t}${i}${a}${l}${n}${r}`}const s=(0,l.ad)(n.w),o=(0,a.v0)(n.w),c=(0,l.hJ)(s,"users"),d=(0,l.JU)(c,o.currentUser.uid),u=(0,l.hJ)(d,"banners"),g=(0,l.JU)(u,"banner");(0,l.hJ)(g,"MainTop")},8762:function(e,t,i){i.d(t,{Z:function(){return g}});var a=i(3396);const l=e=>((0,a.dD)("data-v-bb536a1a"),e=e(),(0,a.Cn)(),e),n={class:"box-1"},r=["checked"],s=l((()=>(0,a._)("span",{class:"toogle"},null,-1)));function o(e,t,i,l,o,c){return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("input",{checked:!i.modelValue,onChange:t[0]||(t[0]=t=>e.$emit("update:modelValue",!i.modelValue)),id:"2",type:"checkbox"},null,40,r),s])}var c={props:{id:String,label:String,modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}}},d=i(89);const u=(0,d.Z)(c,[["render",o],["__scopeId","data-v-bb536a1a"]]);var g=u},6988:function(e,t,i){i.d(t,{Z:function(){return D}});var a=i(3396),l=i(7139);const n={class:"content-block"},r={class:"img-block mb-1"},s={class:"image-wrapper"},o=["src"],c=["src"],d={key:0,class:"error-message"};function u(e,t,i,u,g,m){const h=(0,a.up)("card-component");return(0,a.wg)(),(0,a.j4)(h,{class:"card-dark",title:i.title},{tools:(0,a.w5)((()=>[])),body:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a._)("div",r,[(0,a._)("div",s,[i.imgObject&&i.imgObject.src?((0,a.wg)(),(0,a.iD)("img",{key:0,src:i.imgObject.src,alt:"Uploaded Image",class:"img"},null,8,o)):i.imgObject&&i.imgObject.link?((0,a.wg)(),(0,a.iD)("img",{key:1,src:i.imgObject.link,alt:"Uploaded Image",class:"img"},null,8,c)):(0,a.kq)("",!0),(0,a._)("input",{ref:"fileInput",type:"file",class:"fileInput",accept:"image/*",onChange:t[0]||(t[0]=(...e)=>m.onFileChange&&m.onFileChange(...e))},null,544),i.imgObject.src||i.imgObject.link?((0,a.wg)(),(0,a.iD)("button",{key:2,class:"btn change-img",type:"button",onClick:t[1]||(t[1]=e=>m.SelectFile())}," Змінити ")):(0,a.kq)("",!0),i.imgObject.src||i.imgObject.link?((0,a.wg)(),(0,a.iD)("button",{key:3,class:"btn del-img",type:"button",onClick:t[2]||(t[2]=e=>m.DeleteImage())}," Видалити ")):((0,a.wg)(),(0,a.iD)("button",{key:4,class:"btn add-img",type:"button",onClick:t[3]||(t[3]=e=>m.SelectFile())},"Добавити"))])])]),i.error?((0,a.wg)(),(0,a.iD)("div",d,(0,l.zw)(i.error),1)):(0,a.kq)("",!0)])),_:1},8,["title"])}i(7658);var g=i(1994),m=i(5660),h=i(9242);const p={components:{cardComponent:g.Z},props:{imgObject:{type:Object,default:()=>({id:1,src:"",link:""})},title:String,error:String,deleteList:{type:Array,default:()=>[]}},methods:{DeleteImage(){if(null!=this.imgObject.link){const e=this.deleteList;e.push(this.imgObject.id),this.$emit("update:deleteList",e)}this.$emit("update:imgObject",{})},SelectFile(){this.$refs.fileInput.click()},onFileChange(e){const t=e.target.files[0];if(t){const e=URL.createObjectURL(t),i={id:this.imgObject.id?this.imgObject.id:(0,m.Cf)(),src:e};this.$emit("update:imgObject",i),this.$refs.fileInput.value=""}}}},f=()=>{(0,h.sj)((e=>({"61b5e55e":e.gridRows})))},y=p.setup;p.setup=y?(e,t)=>(f(),y(e,t)):f;var b=p,k=i(89);const v=(0,k.Z)(b,[["render",u],["__scopeId","data-v-3f706300"]]);var D=v},4058:function(e,t,i){i.d(t,{Z:function(){return _}});var a=i(3396),l=i(7139);const n=e=>((0,a.dD)("data-v-22716d53"),e=e(),(0,a.Cn)(),e),r={class:"content-block"},s={class:"img-block mb-1"},o={key:0},c=["src"],d=["src"],u=["onClick"],g=n((()=>(0,a._)("span",null,"Змінити",-1))),m=[g],h=["onClick"],p=n((()=>(0,a._)("span",null,"Видалити",-1))),f=[p],y={class:"image-wrapper d-inline-block"},b={key:0},k={key:0,class:"error-message"};function v(e,t,i,n,g,p){const v=(0,a.up)("card-component");return(0,a.wg)(),(0,a.j4)(v,{class:"card-dark",title:"Галерея картинок"},{tools:(0,a.w5)((()=>[])),body:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a._)("div",s,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.imgsArray,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"image-wrapper d-inline-block",key:e.id},[i.imgsArray?((0,a.wg)(),(0,a.iD)("div",o,[e.src?((0,a.wg)(),(0,a.iD)("img",{key:0,src:e.src,alt:"Uploaded Image",class:"img"},null,8,c)):e.link?((0,a.wg)(),(0,a.iD)("img",{key:1,src:e.link,alt:"Uploaded Image",class:"img"},null,8,d)):(0,a.kq)("",!0),(0,a._)("input",{ref_for:!0,ref:"fileInput",type:"file",class:"fileInput",accept:"image/*",onChange:t[0]||(t[0]=(...e)=>p.onFileChange&&p.onFileChange(...e))},null,544),(0,a._)("button",{class:"btn change-img",type:"button",onClick:t=>p.SelectFile(e.id)},m,8,u),i.imgsArray?((0,a.wg)(),(0,a.iD)("button",{key:2,class:"btn del-img",type:"button",onClick:t=>p.DeleteImage(e.id)},f,8,h)):(0,a.kq)("",!0)])):(0,a.kq)("",!0)])))),128)),(0,a._)("div",y,[(0,a._)("input",{ref:"fileInput",type:"file",class:"fileInput",accept:"image/*",onChange:t[1]||(t[1]=(...e)=>p.onFileChange&&p.onFileChange(...e)),multiple:""},null,544),(0,a._)("button",{class:"btn add-img",type:"button",onClick:t[2]||(t[2]=e=>p.SelectFile("new"))},[i.imgsArray?((0,a.wg)(),(0,a.iD)("span",b,"Добавити")):(0,a.kq)("",!0)])])])]),i.error?((0,a.wg)(),(0,a.iD)("div",k,(0,l.zw)(i.error),1)):(0,a.kq)("",!0)])),_:1})}i(7658);var D=i(5660),w=i(1994),$=i(9242);const I={components:{cardComponent:w.Z},data(){return{currentImgId:null}},props:{imgsArray:{type:Array,default:()=>[]},title:String,error:String,deleteList:{type:Array,default:()=>[]}},methods:{DeleteImage(e){if(this.imgsArray.find((t=>t.id===e&&t.link))){const t=this.deleteList;t.push(e),this.$emit("update:deleteList",t)}const t=this.imgsArray.filter((t=>t.id!==e));this.$emit("update:imgsArray",t)},SelectFile(e){this.currentImgId=e,this.$refs.fileInput.click()},onFileChange(e){const t=e.target.files;if(t){const e=this.imgsArray;if("new"!==this.currentImgId&&null!==this.currentImgId){const e=URL.createObjectURL(t[t.length-1]),i=this.imgsArray.map((t=>t.id===this.currentImgId?{...t,src:e}:t));this.$emit("update:imgsArray",i)}else{for(let i=0;i<t.length;i++){const a=URL.createObjectURL(t[i]),l={id:`${(0,D.Cf)()}${i}`,src:a};e.push(l)}this.$emit("update:imgsArray",e)}}e.target.value=null}}},C=()=>{(0,$.sj)((e=>({"3018325b":e.gridRows})))},L=I.setup;I.setup=L?(e,t)=>(C(),L(e,t)):C;var F=I,U=i(89);const V=(0,U.Z)(F,[["render",v],["__scopeId","data-v-22716d53"]]);var _=V},1436:function(e,t,i){i.r(t),i.d(t,{default:function(){return T}});var a=i(3396),l=i(7139),n=i(9242);const r={class:"btn-group btn-group-toggle","data-toggle":"buttons"},s=["id"],o=(0,a._)("span",null,"Зберегти",-1),c=[o],d=(0,a._)("span",null,"Зберегти",-1),u=[d];function g(e,t,i,o,d,g){const m=(0,a.up)("addFilmC"),h=(0,a.up)("card");return(0,a.wg)(),(0,a.j4)(h,{title:d.title,isLoading:g.isLoading},{tools:(0,a.w5)((()=>[(0,a._)("div",r,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.languages,(e=>((0,a.wg)(),(0,a.iD)("label",{key:e.id,class:(0,l.C_)(["btn btn-secondary",{active:e.checked}])},[(0,a._)("input",{type:"radio",name:"options",id:e.id,autocomplete:"off",onChange:t[0]||(t[0]=(...e)=>g.changeCheckbox&&g.changeCheckbox(...e))},null,40,s),(0,a.Uk)(" "+(0,l.zw)(e.name),1)],2)))),128))])])),body:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(m,{language:"Ua",collectionRef:g.collection("Ua"),id:d.id,onIsLoading:g.changeLoadingUa,saveTriger:d.saveTriger,onErorr:g.changeErorrUa},null,8,["collectionRef","id","onIsLoading","saveTriger","onErorr"]),[[n.F8,"Ua"===g.currenLanguage]]),(0,a.wy)((0,a.Wm)(m,{language:"En",collectionRef:g.collection("En"),id:d.id,onIsLoading:g.changeLoadingEn,saveTriger:d.saveTriger,onErorr:g.changeErorrEn},null,8,["collectionRef","id","onIsLoading","saveTriger","onErorr"]),[[n.F8,"En"===g.currenLanguage]]),(0,a._)("button",{onClick:t[1]||(t[1]=(...e)=>g.Save&&g.Save(...e)),class:"btn btn-xs btn-success col fileinput-button"},c)])),footer:(0,a.w5)((()=>[(0,a._)("span",{class:"btn btn-xs btn-success col fileinput-button",onClick:t[2]||(t[2]=(...e)=>g.Save&&g.Save(...e))},u)])),_:1},8,["title","isLoading"])}i(7658);var m=i(4219),h=i(4494),p=i(36),f=i(4592),y=i(5660),b=i(1994);const k={key:0,class:"error-message"},v={key:1,class:"error-message"},D={class:"form-group mt-3 ml-1"},w=(0,a._)("p",null,[(0,a._)("strong",null,"Тип фільма")],-1),$={key:0,class:"error-message"};function I(e,t,i,r,s,o){const c=(0,a.up)("input-component"),d=(0,a.up)("textarea-component"),u=(0,a.up)("img-component"),g=(0,a.up)("imgs-component"),m=(0,a.up)("checkbox-component"),h=(0,a.up)("seo-component");return(0,a.wg)(),(0,a.iD)("form",{action:"",onSubmit:t[10]||(t[10]=(0,n.iM)(((...e)=>o.Save&&o.Save(...e)),["prevent"]))},[(0,a.Wm)(c,{label:"Назва фільма",id:"filmName",type:"text",placeholder:"Введіть назву фільма",modelValue:s.filmName,"onUpdate:modelValue":t[0]||(t[0]=e=>s.filmName=e),error:r.v$.filmName.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,a.Wm)(c,{class:"mt-3",label:"Дата виходу",id:"releaseDate",type:"date",placeholder:"Введіть дату виходу",modelValue:s.releaseDate,"onUpdate:modelValue":t[1]||(t[1]=e=>s.releaseDate=e),error:r.v$.releaseDate.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,a.Wm)(d,{class:"mt-3",label:"Опис",id:"filmDescription",type:"textarea",placeholder:"Введіть опис фільма",modelValue:s.filmDescription,"onUpdate:modelValue":t[2]||(t[2]=e=>s.filmDescription=e),error:r.v$.filmDescription.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,a.Wm)(u,{modelValue:s.mainPicture,"onUpdate:modelValue":t[3]||(t[3]=e=>s.mainPicture=e),class:(0,l.C_)([{"is-invalid":r.v$.mainPicture.$error},"mt-3"]),onDeleteMainPicture:o.delImage},null,8,["modelValue","class","onDeleteMainPicture"]),r.v$.mainPicture.$error?((0,a.wg)(),(0,a.iD)("p",k,"Виберіть картинку")):(0,a.kq)("",!0),(0,a.Wm)(g,{modelValue:s.gallary,"onUpdate:modelValue":t[4]||(t[4]=e=>s.gallary=e),class:(0,l.C_)([{"is-invalid":r.v$.gallary.$error},"mt-3"]),onNewImage:o.addImage,onDelImage:o.delImage,onChangeImage:o.changeImage},null,8,["modelValue","class","onNewImage","onDelImage","onChangeImage"]),r.v$.gallary.$error?((0,a.wg)(),(0,a.iD)("p",v,"Виберіть картинку")):(0,a.kq)("",!0),(0,a.Wm)(c,{class:"mt-3",label:"Силка на трейлер",id:"trailerLink",type:"text",placeholder:"Введіть силку на трейлер в youtube...",modelValue:s.trailerLink,"onUpdate:modelValue":t[5]||(t[5]=e=>s.trailerLink=e),error:r.v$.trailerLink.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,a._)("div",D,[w,(0,a._)("div",{class:(0,l.C_)(["row",{"is-invalid":r.v$.typeFilm.$error}])},[(0,a.Wm)(m,{modelValue:s.typeFilm["3D"],"onUpdate:modelValue":t[6]||(t[6]=e=>s.typeFilm["3D"]=e),id:"3D",label:"3D"},null,8,["modelValue"]),(0,a.Wm)(m,{modelValue:s.typeFilm["2D"],"onUpdate:modelValue":t[7]||(t[7]=e=>s.typeFilm["2D"]=e),id:"2D",label:"2D"},null,8,["modelValue"]),(0,a.Wm)(m,{modelValue:s.typeFilm.IMAX,"onUpdate:modelValue":t[8]||(t[8]=e=>s.typeFilm.IMAX=e),id:"IMAX",label:"IMAX"},null,8,["modelValue"])],2),r.v$.typeFilm.$error?((0,a.wg)(),(0,a.iD)("p",$,"Виберіть тип фільма")):(0,a.kq)("",!0)]),(0,a.Wm)(h,{modelValue:s.SEO,"onUpdate:modelValue":t[9]||(t[9]=e=>s.SEO=e)},null,8,["modelValue"])],32)}var C=i(5420),L=i(7316),F=i(599),U=i(6988),V=i(4058),_=i(8762),S=i(7335),j=i(151),E=i(373),O=i.n(E),A={components:{inputComponent:L.Z,imgComponent:U.Z,imgsComponent:V.Z,checkboxComponent:_.Z,SeoComponent:S.Z,textareaComponent:F.Z},setup(){const e=(0,m.Xw)();return{v$:e}},data(){return{filmName:"",releaseDate:"",filmDescription:"",mainPicture:{},gallary:[],trailerLink:"",typeFilm:{"3D":!1,"2D":!1,IMAX:!1},SEO:{link:"",title:"",keywords:"",description:""},ListDeleteImages:[],cloudFirestore:new h.r,cloudStorage:new j.o}},props:{language:String,collectionRef:Object,id:String,saveTriger:Boolean},mounted(){this.GetFilm()},validations(){return{filmName:{required:C.C1,$lazy:!0},releaseDate:{required:C.C1,$lazy:!0},filmDescription:{required:C.C1,$lazy:!0},mainPicture:{required:C.C1,$lazy:!0},gallary:{required:C.C1,$lazy:!0},trailerLink:{required:C.C1,$lazy:!0},typeFilm:{required(e){return Object.values(e).some((e=>e))},$lazy:!0}}},computed:{fileFolderPath(){return`films/${this.language}/${this.id}`}},methods:{addImage(e){this.gallary.push(e)},delImage(e){this.ListDeleteImages.push(e)},changeImage(e){this.gallary=this.gallary.map((t=>t.id===e.id?e:t))},GetFilm(){this.ListDeleteImages=[],this.cloudFirestore.getDocument(this.collectionRef,this.$route.params.id).then((e=>{e&&Object.assign(this.$data,e)}))},async Save(){try{if(this.$emit("isLoading",!0),this.ListDeleteImages){for(let e=0;e<this.ListDeleteImages.length;e++)this.cloudStorage.DeleteFileInFirebaseStorage(this.fileFolderPath,this.ListDeleteImages[e]);this.ListDeleteImages=[]}if(await this.v$.$validate()){if(this.mainPicture.src?(this.mainPicture.link=await this.cloudStorage.UploadFile(this.fileFolderPath,this.mainPicture),this.saveListImgTriger=!this.saveListImgTriger,delete this.mainPicture.src):delete this.mainPicture,this.gallary.length)for(let t=0;t<this.gallary.length;t++)this.gallary[t].src&&(this.gallary[t].link=await this.cloudStorage.UploadFile(this.fileFolderPath,this.gallary[t]),delete this.gallary[t].src);const e={fileName:this.id,filmName:this.filmName,releaseDate:this.releaseDate,filmDescription:this.filmDescription,typeFilm:this.typeFilm,SEO:this.SEO,gallary:this.gallary,mainPicture:this.mainPicture,trailerLink:this.trailerLink};this.cloudFirestore.AddDocument(this.collectionRef,this.id,e)}console.log("save"),O().success(this.language),this.$emit("isLoading",!1)}catch(e){const t={unknown:"Сталася невідома помилка при збереженні даних."};this.$emit("erorr",!0);const i=t[e.code]||"Не вдалося зберегти дані.";throw new Error(i)}}},watch:{saveTriger(){this.Save()}}},P=i(89);const q=(0,P.Z)(A,[["render",I]]);var Z=q,R={setup(){const e=(0,m.Xw)();return{v$:e}},data(){return{id:null,isLoadingUa:!1,isLoadingEn:!1,erorrUa:!1,erorrEn:!1,formValidate:!1,saveTriger:!1,uaValidate:!1,enValidate:!1,title:"Фільм",languages:[{id:0,name:"Українська",value:"Ua",checked:!1},{id:1,name:"Англійська",value:"En",checked:!0}],cloudFirestore:new h.r}},created(){this.GetFilm()},components:{card:b.Z,addFilmC:Z},computed:{isLoading(){return!0===this.isLoadingEn||!0===this.isLoadingUa},error(){return!1!==this.erorrUa||!1!==this.erorrEn},curentIndex(){return!0===this.languages[0].checked?0:1},currenLanguage(){return!0===this.languages[0].checked?this.languages[0].value:this.languages[1].value},collectionRef(){const e=(0,p.JU)(f.hS,this.currenLanguage),t=(0,p.hJ)(e,"films");return t}},methods:{changeValidateStatus(e,t){t===this.uaValidate?this.uaValidate=e:this.enValidate=e},changeErorrUa(e){this.erorrUa=e},changeErorrEn(e){this.erorrEn=e},changeLoadingUa(e){this.isLoadingUa=e},changeLoadingEn(e){this.isLoadingEn=e},collection(e){const t=(0,p.JU)(f.hS,e),i=(0,p.hJ)(t,"films");return i},GetFilm(){this.cloudFirestore.getDocument(this.collection("En"),this.$route.params.id).then((e=>{e?this.id=this.$route.params.id:this.cloudFirestore.getDocument(this.collection("Ua"),this.$route.params.id).then((e=>{e?this.id=this.$route.params.id:(this.$router.push("New_Film"),this.id=(0,y.Cf)())}))}))},changeCheckbox(){!0===this.languages[0].checked?(this.languages[0].checked=!1,this.languages[1].checked=!0):(this.languages[1].checked=!1,this.languages[0].checked=!0)},async Save(){await this.v$.$validate()&&(this.saveTriger=!this.saveTriger)}}};const x=(0,P.Z)(R,[["render",g]]);var T=x}}]);
//# sourceMappingURL=933.b687f367.js.map