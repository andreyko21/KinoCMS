"use strict";(self["webpackChunkkinocms"]=self["webpackChunkkinocms"]||[]).push([[679],{5660:function(e,t,a){a.d(t,{Cf:function(){return s}});var i=a(1609),n=a(36),l=a(1614);function s(){const e=new Date,t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),n=e.getHours(),l=e.getMinutes(),s=e.getSeconds();return`${t}${a}${i}${n}${l}${s}`}const r=(0,n.ad)(l.w),o=(0,i.v0)(l.w),d=(0,n.hJ)(r,"users"),c=(0,n.JU)(d,o.currentUser.uid),u=(0,n.hJ)(c,"banners"),g=(0,n.JU)(u,"banner");(0,n.hJ)(g,"MainTop")},8762:function(e,t,a){a.d(t,{Z:function(){return g}});var i=a(3396);const n=e=>((0,i.dD)("data-v-bb536a1a"),e=e(),(0,i.Cn)(),e),l={class:"box-1"},s=["checked"],r=n((()=>(0,i._)("span",{class:"toogle"},null,-1)));function o(e,t,a,n,o,d){return(0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("input",{checked:!a.modelValue,onChange:t[0]||(t[0]=t=>e.$emit("update:modelValue",!a.modelValue)),id:"2",type:"checkbox"},null,40,s),r])}var d={props:{id:String,label:String,modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}}},c=a(89);const u=(0,c.Z)(d,[["render",o],["__scopeId","data-v-bb536a1a"]]);var g=u},6988:function(e,t,a){a.d(t,{Z:function(){return f}});var i=a(3396),n=a(7139);const l={class:"content-block"},s={class:"img-block mb-1"},r={class:"image-wrapper"},o=["src"],d=["src"],c={key:0,class:"error-message"};function u(e,t,a,u,g,m){const p=(0,i.up)("card-component");return(0,i.wg)(),(0,i.j4)(p,{class:"card-dark",title:a.title},{tools:(0,i.w5)((()=>[])),body:(0,i.w5)((()=>[(0,i._)("div",l,[(0,i._)("div",s,[(0,i._)("div",r,[a.imgObject&&a.imgObject.src?((0,i.wg)(),(0,i.iD)("img",{key:0,src:a.imgObject.src,alt:"Uploaded Image",class:"img"},null,8,o)):a.imgObject&&a.imgObject.link?((0,i.wg)(),(0,i.iD)("img",{key:1,src:a.imgObject.link,alt:"Uploaded Image",class:"img"},null,8,d)):(0,i.kq)("",!0),(0,i._)("input",{ref:"fileInput",type:"file",class:"fileInput",accept:"image/*",onChange:t[0]||(t[0]=(...e)=>m.onFileChange&&m.onFileChange(...e))},null,544),a.imgObject.src||a.imgObject.link?((0,i.wg)(),(0,i.iD)("button",{key:2,class:"btn change-img",type:"button",onClick:t[1]||(t[1]=e=>m.SelectFile())}," Змінити ")):(0,i.kq)("",!0),a.imgObject.src||a.imgObject.link?((0,i.wg)(),(0,i.iD)("button",{key:3,class:"btn del-img",type:"button",onClick:t[2]||(t[2]=e=>m.DeleteImage())}," Видалити ")):((0,i.wg)(),(0,i.iD)("button",{key:4,class:"btn add-img",type:"button",onClick:t[3]||(t[3]=e=>m.SelectFile())},"Добавити"))])])]),a.error?((0,i.wg)(),(0,i.iD)("div",c,(0,n.zw)(a.error),1)):(0,i.kq)("",!0)])),_:1},8,["title"])}a(7658);var g=a(1994),m=a(5660),p=a(9242);const h={components:{cardComponent:g.Z},props:{imgObject:{type:Object,default:()=>({id:1,src:"",link:""})},title:String,error:String,deleteList:{type:Array,default:()=>[]}},methods:{DeleteImage(){if(null!=this.imgObject.link){const e=this.deleteList;e.push(this.imgObject.id),this.$emit("update:deleteList",e)}this.$emit("update:imgObject",{})},SelectFile(){this.$refs.fileInput.click()},onFileChange(e){const t=e.target.files[0];if(t){const e=URL.createObjectURL(t),a={id:this.imgObject.id?this.imgObject.id:(0,m.Cf)(),src:e};this.$emit("update:imgObject",a),this.$refs.fileInput.value=""}}}},b=()=>{(0,p.sj)((e=>({"61b5e55e":e.gridRows})))},v=h.setup;h.setup=v?(e,t)=>(b(),v(e,t)):b;var k=h,y=a(89);const I=(0,y.Z)(k,[["render",u],["__scopeId","data-v-3f706300"]]);var f=I},4058:function(e,t,a){a.d(t,{Z:function(){return j}});var i=a(3396),n=a(7139);const l=e=>((0,i.dD)("data-v-22716d53"),e=e(),(0,i.Cn)(),e),s={class:"content-block"},r={class:"img-block mb-1"},o={key:0},d=["src"],c=["src"],u=["onClick"],g=l((()=>(0,i._)("span",null,"Змінити",-1))),m=[g],p=["onClick"],h=l((()=>(0,i._)("span",null,"Видалити",-1))),b=[h],v={class:"image-wrapper d-inline-block"},k={key:0},y={key:0,class:"error-message"};function I(e,t,a,l,g,h){const I=(0,i.up)("card-component");return(0,i.wg)(),(0,i.j4)(I,{class:"card-dark",title:"Галерея картинок"},{tools:(0,i.w5)((()=>[])),body:(0,i.w5)((()=>[(0,i._)("div",s,[(0,i._)("div",r,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.imgsArray,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"image-wrapper d-inline-block",key:e.id},[a.imgsArray?((0,i.wg)(),(0,i.iD)("div",o,[e.src?((0,i.wg)(),(0,i.iD)("img",{key:0,src:e.src,alt:"Uploaded Image",class:"img"},null,8,d)):e.link?((0,i.wg)(),(0,i.iD)("img",{key:1,src:e.link,alt:"Uploaded Image",class:"img"},null,8,c)):(0,i.kq)("",!0),(0,i._)("input",{ref_for:!0,ref:"fileInput",type:"file",class:"fileInput",accept:"image/*",onChange:t[0]||(t[0]=(...e)=>h.onFileChange&&h.onFileChange(...e))},null,544),(0,i._)("button",{class:"btn change-img",type:"button",onClick:t=>h.SelectFile(e.id)},m,8,u),a.imgsArray?((0,i.wg)(),(0,i.iD)("button",{key:2,class:"btn del-img",type:"button",onClick:t=>h.DeleteImage(e.id)},b,8,p)):(0,i.kq)("",!0)])):(0,i.kq)("",!0)])))),128)),(0,i._)("div",v,[(0,i._)("input",{ref:"fileInput",type:"file",class:"fileInput",accept:"image/*",onChange:t[1]||(t[1]=(...e)=>h.onFileChange&&h.onFileChange(...e)),multiple:""},null,544),(0,i._)("button",{class:"btn add-img",type:"button",onClick:t[2]||(t[2]=e=>h.SelectFile("new"))},[a.imgsArray?((0,i.wg)(),(0,i.iD)("span",k,"Добавити")):(0,i.kq)("",!0)])])])]),a.error?((0,i.wg)(),(0,i.iD)("div",y,(0,n.zw)(a.error),1)):(0,i.kq)("",!0)])),_:1})}a(7658);var f=a(5660),w=a(1994),$=a(9242);const L={components:{cardComponent:w.Z},data(){return{currentImgId:null}},props:{imgsArray:{type:Array,default:()=>[]},title:String,error:String,deleteList:{type:Array,default:()=>[]}},methods:{DeleteImage(e){if(this.imgsArray.find((t=>t.id===e&&t.link))){const t=this.deleteList;t.push(e),this.$emit("update:deleteList",t)}const t=this.imgsArray.filter((t=>t.id!==e));this.$emit("update:imgsArray",t)},SelectFile(e){this.currentImgId=e,this.$refs.fileInput.click()},onFileChange(e){const t=e.target.files;if(t){const e=this.imgsArray;if("new"!==this.currentImgId&&null!==this.currentImgId){const e=URL.createObjectURL(t[t.length-1]),a=this.imgsArray.map((t=>t.id===this.currentImgId?{...t,src:e}:t));this.$emit("update:imgsArray",a)}else{for(let a=0;a<t.length;a++){const i=URL.createObjectURL(t[a]),n={id:`${(0,f.Cf)()}${a}`,src:i};e.push(n)}this.$emit("update:imgsArray",e)}}e.target.value=null}}},C=()=>{(0,$.sj)((e=>({"3018325b":e.gridRows})))},V=L.setup;L.setup=V?(e,t)=>(C(),V(e,t)):C;var _=L,D=a(89);const F=(0,D.Z)(_,[["render",I],["__scopeId","data-v-22716d53"]]);var j=F},5402:function(e,t,a){a.d(t,{Z:function(){return u}});var i=a(3396),n=a(7139);const l={class:"btn-group btn-group-toggle"},s=["id","onClick"];function r(e,t,a,r,o,d){return(0,i.wg)(),(0,i.iD)("div",l,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.languages,(e=>((0,i.wg)(),(0,i.iD)("label",{key:e.id,class:(0,n.C_)(["btn btn-secondary",{active:e.checked,error:a.error[e.id].$errors.length}])},[(0,i._)("input",{type:"radio",name:"options",id:e.name,autocomplete:"off",onClick:t=>d.changeLanguage(e.id)},null,8,s),(0,i.Uk)(" "+(0,n.zw)(e.name),1)],2)))),128))])}var o={props:{error:Object,languages:{type:Array,default:()=>[{id:0,name:"",abbreviation:"",checked:!1}]}},methods:{changeLanguage(e){for(const t of this.languages)t.id===e?t.checked=!0:!0===t.checked&&(t.checked=!1)}}},d=a(89);const c=(0,d.Z)(o,[["render",r],["__scopeId","data-v-1fd42b0c"]]);var u=c},9265:function(e,t,a){a.r(t),a.d(t,{default:function(){return q}});var i=a(3396);const n=(0,i._)("span",null,"Зберегти",-1),l=[n];function s(e,t,a,n,s,r){const o=(0,i.up)("checkbox-component"),d=(0,i.up)("language-component"),c=(0,i.up)("add-news-form"),u=(0,i.up)("card");return(0,i.wg)(),(0,i.j4)(u,{title:s.title,isLoading:s.isLoading},{tools:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(o,{modelValue:s.checkedPage,"onUpdate:modelValue":t[0]||(t[0]=e=>s.checkedPage=e)},null,8,["modelValue"])]),(0,i.Wm)(d,{languages:s.languages,"onUpdate:languages":t[1]||(t[1]=e=>s.languages=e),error:n.v$.languages},null,8,["languages","error"])])),body:(0,i.w5)((()=>[(0,i.Wm)(c,{modelValue:r.currentLanguage.data,"onUpdate:modelValue":t[2]||(t[2]=e=>r.currentLanguage.data=e)},null,8,["modelValue"]),(0,i._)("button",{type:"submit",onClick:t[3]||(t[3]=(...e)=>r.Save&&r.Save(...e)),class:"btn btn-xs btn-success col fileinput-button"},l)])),_:1},8,["title","isLoading"])}a(7658);var r=a(8762),o=a(4494),d=a(151),c=a(4219),u=a(5420),g=a(4592),m=a(7139);const p={action:""};function h(e,t,a,n,l,s){const r=(0,i.up)("input-component"),o=(0,i.up)("textarea-component"),d=(0,i.up)("img-component"),c=(0,i.up)("imgs-component"),u=(0,i.up)("seo-component");return(0,i.wg)(),(0,i.iD)("form",p,[(0,i.Wm)(r,{label:"Назва новини",id:"newsName",type:"text",placeholder:"Введіть назву новини",modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.name=e),error:n.v$.name.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,i.Wm)(r,{label:"Дата публікації",id:"datePublication",class:"mt-3",type:"date",placeholder:"Введіть дату публікації",modelValue:n.datePublication,"onUpdate:modelValue":t[1]||(t[1]=e=>n.datePublication=e),error:n.v$.datePublication.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,i.Wm)(o,{class:"mt-3",label:"Опис",id:"newsDescription",type:"textarea",placeholder:"Введіть опис новини",modelValue:n.description,"onUpdate:modelValue":t[2]||(t[2]=e=>n.description=e),error:n.v$.description.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,i.Wm)(d,{imgObject:n.mainImg,"onUpdate:imgObject":t[3]||(t[3]=e=>n.mainImg=e),deleteList:n.deleteImgList,"onUpdate:deleteList":t[4]||(t[4]=e=>n.deleteImgList=e),class:(0,m.C_)([{"is-invalid":n.v$.mainImg.$error},"mt-3"]),title:"Головна картинка",error:n.v$.mainImg.$error?"Виберіть картинку":""},null,8,["imgObject","deleteList","class","error"]),(0,i.Wm)(c,{imgsArray:n.galleryImg,"onUpdate:imgsArray":t[5]||(t[5]=e=>n.galleryImg=e),deleteList:n.deleteImgList,"onUpdate:deleteList":t[6]||(t[6]=e=>n.deleteImgList=e),class:(0,m.C_)([{"is-invalid":n.v$.galleryImg.$error},"mt-3"]),title:"Галерея картинок",error:n.v$.galleryImg.$error?"Виберіть картинку":""},null,8,["imgsArray","deleteList","class","error"]),(0,i.Wm)(r,{label:"Силка на відео",id:"videoLink",type:"text",placeholder:"Введіть силку на відео",modelValue:n.videoLink,"onUpdate:modelValue":t[7]||(t[7]=e=>n.videoLink=e),error:n.v$.videoLink.$error?"Поле є обовязковим":""},null,8,["modelValue","error"]),(0,i.Wm)(u,{modelValue:n.seo,"onUpdate:modelValue":t[8]||(t[8]=e=>n.seo=e)},null,8,["modelValue"])])}var b=a(599),v=a(7316),k=a(6988),y=a(4058),I=a(7335),f=a(4870),w={components:{inputComponent:v.Z,textareaComponent:b.Z,imgComponent:k.Z,imgsComponent:y.Z,SeoComponent:I.Z},props:{modelValue:{type:Object,default:()=>({newsName:"",datePublication:"",newsDescription:"",mainImg:{},galleryImg:[],videoLink:"",seo:{},deleteImgList:[]})}},setup(e,{emit:t}){const a=(0,c.Xw)(),n=(0,f.iH)(e.modelValue.name),l=(0,f.iH)(e.modelValue.datePublication),s=(0,f.iH)(e.modelValue.description),r=(0,f.iH)(e.modelValue.mainImg),o=(0,f.iH)(e.modelValue.galleryImg),d=(0,f.iH)(e.modelValue.videoLink),u=(0,f.iH)(e.modelValue.seo),g=(0,f.iH)(e.modelValue.deleteImgList),m=()=>{t("update:modelValue",{name:n.value?n.value:"",datePublication:l.value?l.value:"",description:s.value?s.value:"",mainImg:r.value?r.value:{},galleryImg:o.value?o.value:[],videoLink:d.value?d.value:"",seo:u.value?u.value:{},deleteImgList:g.value?g.value:[]})};return(0,i.m0)((()=>{n.value=e.modelValue.name,l.value=e.modelValue.datePublication,s.value=e.modelValue.description,r.value=e.modelValue.mainImg,o.value=e.modelValue.galleryImg,d.value=e.modelValue.videoLink,u.value=e.modelValue.seo,g.value=e.modelValue.deleteImgList})),(0,i.YP)([n,l,s,r,o,d,u,g],m),{v$:a,name:n,datePublication:l,description:s,mainImg:r,galleryImg:o,videoLink:d,seo:u,deleteImgList:g}},validations(){return{name:{required:u.C1,$lazy:!0},datePublication:{required:u.C1,$lazy:!0},description:{required:u.C1,$lazy:!0},mainImg:{required:u.C1,$lazy:!0},galleryImg:{required:u.C1,$lazy:!0},videoLink:{required:u.C1,$lazy:!0}}}},$=a(89);const L=(0,$.Z)(w,[["render",h],["__scopeId","data-v-fdd6546a"]]);var C=L,V=a(5402),_=a(5660),D=a(1994),F=a(373),j=a.n(F),U={components:{card:D.Z,addNewsForm:C,LanguageComponent:V.Z,checkboxComponent:r.Z},setup(){const e=(0,c.Xw)();return{v$:e}},data(){return{name:"News",checkedPage:!0,cloudFirestore:new o.r,cloudStorage:new d.o,languages:[{id:0,name:"Українська",abbreviation:"Ua",collection:g.EB,checked:!1,data:{name:"",datePublication:"",description:"",mainImg:{},galleryImg:[],videoLink:"",seo:{},deleteImgList:[]}},{id:1,name:"Англійська",abbreviation:"En",collection:g.nK,checked:!0,data:{name:"",datePublication:"",description:"",mainImg:{},galleryImg:[],videoLink:"",seo:{},deleteImgList:[]}}],title:"Створення новини",isLoading:!1}},validations(){const e=this;return{languages:[...(()=>{const t=[{data:{name:{required:u.C1},datePublication:{required:u.C1},description:{required:u.C1},mainImg:{required:u.C1},galleryImg:{required:u.C1},videoLink:{required:u.C1}}}];return e.languages.forEach(((e,a)=>{a>0&&t.push({data:{name:{required:u.C1},datePublication:{required:u.C1},description:{required:u.C1},mainImg:{required:u.C1},galleryImg:{required:u.C1},videoLink:{required:u.C1}}})})),t})()]}},computed:{currentLanguage(){const e=this.languages.find((e=>!0===e.checked));return e||{}},id(){return this.$route.params[`${this.name}Id`]!==`New_${this.name}`?this.$route.params[`${this.name}Id`]:(0,_.Cf)()}},async created(){this.isLoading=!0,await this.GetFile(this.languages[0]),await this.GetFile(this.languages[1]),this.isLoading=!1},methods:{GetFile(e){this.cloudFirestore.getDocument(e.collection,this.$route.params[`${this.name}Id`]).then((t=>{t?(this.checkedPage=t.checkedPage,Object.assign(e.data,t)):this.$route.params[`${this.name}Id`]!==`New_${this.name}`&&this.$router.push(`/${this.name}`)}))},async DeleteFirebaseImages(e,t){if(void 0!==e&&e.length>0)for(const a of e)await this.cloudStorage.DeleteFileInFirebaseStorage(t,a)},async AddFirebaseImage(e,t){e.src?(e.link=await this.cloudStorage.UploadFile(t,e),delete e.src):e={}},async AddFirebaseImages(e,t){if(e&&e.length)for(let a=0;a<e.length;a++){const i=e[a];i.src&&(i.link=await this.cloudStorage.UploadFile(t,i),delete i.src)}},async AddFirebaseData(e,t){const a=await{checkedPage:this.checkedPage,fileName:this.id,name:e.name,description:e.description,datePublication:e.datePublication,mainImg:e.mainImg,galleryImg:e.galleryImg,videoLink:e.videoLink,seo:e.seo};await this.cloudFirestore.AddDocument(t,this.id,a)},async ResetNews(){this.isLoading=!0,await this.GetNews(this.currentLanguage),j().success("Дані успішно скинуто"),this.isLoading=!1},async Save(){if(this.isLoading=!0,await this.v$.$validate()){for(let e=0;e<this.languages.length;e++)await this.DeleteFirebaseImages(this.languages[e].data.deleteImgList,`${this.name}/${this.languages[e].abbreviation}/${this.id}`),this.languages[e].data.deleteImgList=[],await this.AddFirebaseImage(this.languages[e].data.mainImg,`${this.name}/${this.languages[e].abbreviation}/${this.id}`),await this.AddFirebaseImages(this.languages[e].data.galleryImg,`${this.name}/${this.languages[e].abbreviation}/${this.id}`),await this.AddFirebaseData(this.languages[e].data,this.languages[e].collection);j().success("Дані успішно збережено")}else j().warning("Введіть всі дані");this.isLoading=!1}}};const O=(0,$.Z)(U,[["render",s]]);var q=O}}]);
//# sourceMappingURL=679.7aa3e271.js.map