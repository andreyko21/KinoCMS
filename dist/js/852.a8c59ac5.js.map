{"version":3,"file":"js/852.a8c59ac5.js","mappings":"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","sources":["webpack://kinocms/./src/pages/promotions/add-promotions-page.vue","webpack://kinocms/./src/pages/promotions/add-promotions-page.vue?52d9"],"sourcesContent":["<template>\r\n  <card :title=\"title\" :isLoading=\"isLoading\">\r\n    <template #tools>\r\n      <div>\r\n        <checkbox-component v-model=\"checkedPage\"></checkbox-component>\r\n      </div>\r\n      <language-component v-model:languages=\"languages\" :error=\"v$.languages\"></language-component>\r\n    </template>\r\n    <template #body>\r\n      <add-promotions-form v-model=\"currentLanguage.data\"> </add-promotions-form>\r\n      <button type=\"submit\" @click=\"Save\" class=\"btn btn-xs btn-success col fileinput-button\">\r\n        <span>Зберегти</span>\r\n      </button>\r\n    </template>\r\n  </card>\r\n</template>\r\n\r\n<script>\r\nimport checkboxComponent from '@/components/UI/checkbox-component.vue'\r\nimport { CloudFirestore } from '@/js/cloudFirestore'\r\nimport { CloudStorage } from '@/js/cloudStorage'\r\nimport { useVuelidate } from '@vuelidate/core'\r\nimport { required } from '@vuelidate/validators'\r\nimport { promotionsEnCollectionRef, promotionsUaCollectionRef } from '@/js/collections.js'\r\nimport addPromotionsForm from '@/components/promotions-page/add-promotions-form.vue'\r\nimport LanguageComponent from '@/components/language-component.vue'\r\nimport { GenerateID } from '@/components/baners-page/add-file'\r\nimport card from '@/components/UI/card-component.vue'\r\nimport toastr from 'toastr'\r\nexport default {\r\n  components: { card, addPromotionsForm, LanguageComponent, checkboxComponent },\r\n  setup () {\r\n    const v$ = useVuelidate()\r\n    return { v$ }\r\n  },\r\n  data () {\r\n    return {\r\n      name: 'Promotions',\r\n      checkedPage: true,\r\n      cloudFirestore: new CloudFirestore(),\r\n      cloudStorage: new CloudStorage(),\r\n      languages: [\r\n        {\r\n          id: 0,\r\n          name: 'Українська',\r\n          abbreviation: 'Ua',\r\n          collection: promotionsUaCollectionRef,\r\n          checked: false,\r\n          data: {\r\n            name: '',\r\n            datePublication: '',\r\n            description: '',\r\n            mainImg: {},\r\n            galleryImg: [],\r\n            videoLink: '',\r\n            seo: {},\r\n            deleteImgList: []\r\n          }\r\n        },\r\n        {\r\n          id: 1,\r\n          name: 'Англійська',\r\n          abbreviation: 'En',\r\n          collection: promotionsEnCollectionRef,\r\n          checked: true,\r\n          data: {\r\n            name: '',\r\n            datePublication: '',\r\n            description: '',\r\n            mainImg: {},\r\n            galleryImg: [],\r\n            videoLink: '',\r\n            seo: {},\r\n            deleteImgList: []\r\n          }\r\n        }\r\n      ],\r\n      title: 'Створення акції',\r\n      isLoading: false\r\n    }\r\n  },\r\n  validations () {\r\n    const self = this\r\n    return {\r\n      languages: [\r\n        ...(() => {\r\n          const validatonsArray = [\r\n            {\r\n              data: {\r\n                name: { required },\r\n                datePublication: { required },\r\n                description: { required },\r\n                mainImg: { required },\r\n                galleryImg: { required },\r\n                videoLink: { required }\r\n              }\r\n            }\r\n          ]\r\n          self.languages.forEach((item, index) => {\r\n            if (index > 0) {\r\n              validatonsArray.push({\r\n                data: {\r\n                  name: { required },\r\n                  datePublication: { required },\r\n                  description: { required },\r\n                  mainImg: { required },\r\n                  galleryImg: { required },\r\n                  videoLink: { required }\r\n                }\r\n              })\r\n            }\r\n          })\r\n          return validatonsArray\r\n        })()\r\n      ]\r\n    }\r\n  },\r\n  computed: {\r\n    currentLanguage () {\r\n      const current = this.languages.find((language) => language.checked === true)\r\n      return current || {}\r\n    },\r\n    id () {\r\n      if (this.$route.params[`${this.name}Id`] !== `New_${this.name}`) {\r\n        return this.$route.params[`${this.name}Id`]\r\n      } else {\r\n        return GenerateID()\r\n      }\r\n    }\r\n  },\r\n  async created () {\r\n    this.isLoading = true\r\n    await this.GetFile(this.languages[0])\r\n    await this.GetFile(this.languages[1])\r\n    this.isLoading = false\r\n  },\r\n  methods: {\r\n    GetFile (language) {\r\n      this.cloudFirestore\r\n        .getDocument(language.collection, this.$route.params[`${this.name}Id`])\r\n        .then((document) => {\r\n          if (document) {\r\n            this.checkedPage = document.checkedPage\r\n            Object.assign(language.data, document)\r\n          } else if (this.$route.params[`${this.name}Id`] !== `New_${this.name}`) {\r\n            this.$router.push(`/${this.name}`)\r\n          }\r\n        })\r\n    },\r\n    async DeleteFirebaseImages (listDeleteImages, path) {\r\n      if (listDeleteImages !== undefined && listDeleteImages.length > 0) {\r\n        for (const imageName of listDeleteImages) {\r\n          await this.cloudStorage.DeleteFileInFirebaseStorage(path, imageName)\r\n        }\r\n      }\r\n    },\r\n    async AddFirebaseImage (image, path) {\r\n      if (image.src) {\r\n        image.link = await this.cloudStorage.UploadFile(path, image)\r\n        delete image.src\r\n      } else {\r\n        image = {}\r\n      }\r\n    },\r\n    async AddFirebaseImages (imageList, path) {\r\n      if (imageList && imageList.length) {\r\n        for (let i = 0; i < imageList.length; i++) {\r\n          const image = imageList[i]\r\n          if (image.src) {\r\n            image.link = await this.cloudStorage.UploadFile(path, image)\r\n            delete image.src\r\n          }\r\n        }\r\n      }\r\n    },\r\n    async AddFirebaseData (data, collection) {\r\n      const docData = await {\r\n        checkedPage: this.checkedPage,\r\n        fileName: this.id,\r\n        name: data.name,\r\n        description: data.description,\r\n        datePublication: data.datePublication,\r\n        mainImg: data.mainImg,\r\n        galleryImg: data.galleryImg,\r\n        videoLink: data.videoLink,\r\n        seo: data.seo\r\n      }\r\n      await this.cloudFirestore.AddDocument(collection, this.id, docData)\r\n    },\r\n    async Reset () {\r\n      this.isLoading = true\r\n      await this.GetElement(this.currentLanguage)\r\n      toastr.success('Дані успішно скинуто')\r\n      this.isLoading = false\r\n    },\r\n    async Save () {\r\n      this.isLoading = true\r\n      if (await this.v$.$validate()) {\r\n        for (let i = 0; i < this.languages.length; i++) {\r\n          await this.DeleteFirebaseImages(\r\n            this.languages[i].data.deleteImgList,\r\n            `${this.name}/${this.languages[i].abbreviation}/${this.id}`\r\n          )\r\n          this.languages[i].data.deleteImgList = []\r\n\r\n          await this.AddFirebaseImage(\r\n            this.languages[i].data.mainImg,\r\n            `${this.name}/${this.languages[i].abbreviation}/${this.id}`\r\n          )\r\n          await this.AddFirebaseImages(\r\n            this.languages[i].data.galleryImg,\r\n            `${this.name}/${this.languages[i].abbreviation}/${this.id}`\r\n          )\r\n\r\n          await this.AddFirebaseData(this.languages[i].data, this.languages[i].collection)\r\n        }\r\n        toastr.success('Дані успішно збережено')\r\n      } else {\r\n        toastr.warning('Введіть всі дані')\r\n      }\r\n      this.isLoading = false\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n","import { render } from \"./add-promotions-page.vue?vue&type=template&id=508e6e96\"\nimport script from \"./add-promotions-page.vue?vue&type=script&lang=js\"\nexport * from \"./add-promotions-page.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Andreyko\\\\Documents\\\\kinocms\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","_hoisted_1","_createBlock","_component_card","title","$data","isLoading","tools","_withCtx","_createVNode","_component_checkbox_component","checkedPage","$event","_component_language_component","languages","error","$setup","v$","body","_component_add_promotions_form","$options","currentLanguage","data","type","onClick","_cache","args","Save","class","components","card","addPromotionsForm","LanguageComponent","checkboxComponent","setup","useVuelidate","name","cloudFirestore","CloudFirestore","cloudStorage","CloudStorage","id","abbreviation","collection","promotionsUaCollectionRef","checked","datePublication","description","mainImg","galleryImg","videoLink","seo","deleteImgList","promotionsEnCollectionRef","validations","self","this","validatonsArray","required","forEach","item","index","push","computed","current","find","language","$route","params","GenerateID","async","GetFile","methods","getDocument","then","document","Object","assign","$router","listDeleteImages","path","undefined","length","imageName","DeleteFileInFirebaseStorage","image","src","link","UploadFile","imageList","i","docData","fileName","AddDocument","GetElement","toastr","$validate","DeleteFirebaseImages","AddFirebaseImage","AddFirebaseImages","AddFirebaseData","__exports__","render"],"sourceRoot":""}